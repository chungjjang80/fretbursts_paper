\section{Implementing Burst Variance Analysis}
\label{sec:bva}
In this section we describe how to implement the Burst Variance Analysis (BVA)~\cite{Torella_2011}.
FRETBurts provides well-tested, general-purpose functions for timestamps and burst data 
manipulation and therefore simplifies implementing custom burst analysis algorithms such as BVA.

\subsection{An Introduction to BVA}
Single-molecule FRET histograms show more information than just mean FRET efficiencies. 
While, in general, several peaks indicate the presence of multiple subpopulations, 
a single peak cannot be a priori associated with a single FRET efficiency,
unless a detailed shot-noise analysis is carried out~\cite{Nir_2006,Antonik2006}.
A broad FRET distribution might be attributed to a mixture of multiple species with static but different FRET efficiencies, single species with dynamic fluctuations between multiple FRET states, or a combination of the two cases. Burst Variance Analysis (BVA) is an analysis method for single molecule FRET experiments, developed to detect molecular dynamics~\cite{Torella_2011}. It has been successfully implemented to identify heterogeneities in FRET histograms due to dynamic processes of biomolecules in millisecond time scale~\cite{Torella_2011, Robb_2013}.

BVA analysis consists of four steps: 1) slicing bursts into sub-bursts containing \textit{n} consecutive photons, 2) computing FRET efficiencies of each sub-burst, 3) calculating the empirical standard deviation ($s_E$) of sub-burst FRET efficiencies over the whole burst, and 4) comparing $s_E$ to an expected standard deviation based on shot noise limited distribution~\cite{Torella_2011}. 

A FRET peak originating from a single static FRET efficiency has the minimum width and 
the sub-bursts acceptor counts ($N_a$) will ideally follow a binomial distribution of 
eq.~\ref{eq:binom_dist}, where $n$ is the number of photons in each sub-burst and 
$E$ is the FRET efficiency. In practice, we use the proximity ratio peak position as $E$,
and we expect the standard deviation of the sub-bursts to be distributed according to 
eq.~\ref{eq:binom_std}. This is an approximation because background counts (both from
sample and detector's dark counts) add additional variance that is not taken into account.
However, the approximation works well in practical cases because the background contribution
is normally a small fraction of the total number of counts (therefore it marginally contributes to the variance).

\begin{equation}
\label{eq:binom_dist}
N_a \sim \operatorname{Binom} \{n, E\}
\end{equation}

\begin{equation}
\label{eq:binom_std}
\operatorname{Var}(N_a) = n E\,(1 - E)
\end{equation}

If the observed broadening originates from different molecules having distinct FRET efficiencies without dynamics, $s_E$ of each burst is only affected by shot noise and will follow the expected standard deviation curve rationalized by a binomial distribution (see equation 4 in~\cite{Torella_2011}). However, if the observed broadness is due to millisecond dynamics of single species of biomolecules, $s_E$ of each burst is supposed to be larger than the expected standard deviation and sit above the expected standard deviation curve as shown in figure .
Since FRETBursts is based on open source python packages, BVA can be easily built and implemented by FRETBursts with combination of other python packages (see notebook).  



see section~\ref{sec:ph_streams}