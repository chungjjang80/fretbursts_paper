\subsection{Burst search}
\label{sec:burstsearch}

\subsubsection{Introduction to burst search}
After background estimation, the burst search is the next fundamental step of the analysis. The core "sliding window" algorithm, proposed by Eggeling~\textit{et al.} in 1998~\cite{Eggeling_1998}, involves searching for bursts of photons
in which $m$ consecutive photons are within a minimum time lag $\Delta t$. In other words, the bursts are the the portions of the photon stream where the local a rate (computed using $m$ photons) is above a minimum rate choosen as a threshold. Eggeling did not provide any criteria on how to chose the rate threshold and the number of photons $m$ and as therefore it has become a common practice to manually tweak those parameters for each specific measurement. 

A more general approach consist in taking into accout the background rate of the specific measurements and in choosing a rate threshold that is $F$ times larger than the background rate. This approach assures that the resulting bursts all have a single-to-background ratio (SBR) larger than $(F-1)$~(\cite{Michalet_2012}). A consisten criterium to choose the threshold is very important when comparing different measurements with different background rates, when the background significantly changes during the measurements or in multi-spot measurements where each spot has a different background rates.

A second important aspect of burst search is which photon stream is processed. Usually, when indentifying FRET populations, we want to apply the burst search to all the photons. Other times, when focusing on donor-only or acceptor only population is better to use only the donor or acceptor signal. In general we want to be able to apply the burst search to an arbitrary selection of photons. In FRETBursts this can be achieved passing the appropriate \verb|Ph\_sel| object to the burst search method (see section~\ref{sec:ph_streams} for more info on photon stream definitions).

Finally, Nir~\text{et al.} proposed a refined burst search (AND-gate burst search) that is able to avoid artifacts due to photophysical effects such as blinking. In this case a search is perfomer independently on two photon streams and bursts are marked only when both photon streams exibit a rate higher then the threshold.

\subsubsection{Burst search in FRETBursts}
In FRETBursts the burst search is performed calling the \href{http://fretbursts.readthedocs.org/en/latest/data_class.html#fretbursts.burstlib.Data.burst_search_t}{\verb|burst_search_t| method}


\begin{itemize}
\item Adaptive threshold as a function of background
\item Chosing different photon streams
\item AND-Gate
\end{itemize}

\subsection{Burst selection}

How to select bursts according to different criteria (size, width, E, S, topN, etc...).

How to define a new criterium.


\subsection{Population fit}

\begin{itemize}
\item Histogram fit: chose a model, constraints, methods, accuracy
\item KDE: find the maximum
\end{itemize}

\subsubsection{Correction coefficients}

\begin{itemize}
\item Fit D-only and A-only population.
\item Fit gamma factor.
\end{itemize}


\subsubsection{Accurate FRET}

Apply corrections to the bursts vs apply corrections after the fit.

