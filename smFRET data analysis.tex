\section{smFRET data analysis}

\subsection{Introduction}

In the following we provide a high-level description of FRETbursts usage. In general, we suggest to import FRETbursts with the expression:

\begin{verbatim}
>>> import fretbursts as fb
\end{verbatim}

that will make available all the FRETBursts functions with a concise `fb.` prefix. In this article, however, we assume that FRETBursts is imported with the shortcut form:

\begin{verbatim}
>>> from fretbursts import *
\end{verbatim}

that allows to skip the \verb|fb.| prefix and also imports some common numeric libraries (numpy and matplotlib.pyplot imported as \verb|np| and \verb|plt| respectively).

\subsection{Photon streams}

The fundamental data type in smFRET experiments is the array of photon timestamps. In single-spot measurements, all the timestamps are stored in a single array. In multi-spot measurements we have as many timestamps array as the number of excitation spots.

Each timestamps array contains timestamps from both the donor (D) and the acceptor channel (A). In ALEX measurement, we can further differentiate between photons emitted during D and A excitation periods. In FRETBursts the different selection of photons/timestamps are called "photon streams" and they are specified with a \href{http://fretbursts.readthedocs.org/en/latest/data_class.html#module-fretbursts.ph_sel}{\texttt{Ph\_sel} object} . In non-ALEX smFRET data we have 3 base photon streams (table~\ref{tab:ph_sel_smfret}), while in ALEX data we have 5 base photon streams 
(table~\ref{tab:ph_sel_alex}).

The \verb|Ph_sel| class allows to express any combination of photon streams. For example, in ALEX measurements, the D-emission during A-excitation stream does not contain any useful signal because the donor fluorophore cannot be excited by the longer wavelength used during acceptor excitation. To exclude this photon stream we can use \verb|Ph_sel(Dex='DAem', Aex='Aem')|, that means literally: select donor and acceptor photons during donor excitation and only acceptor photons during acceptor excitation.

\begin{table}
\begin{tabular}{l|l}
  Photon selection  & code \\
  \hline
  All-photons       & \verb|Ph_sel('all')|\\
  D-emission    & \verb|Ph_sel(Dex='Dem')|\\
  A-emission & \verb|Ph_sel(Dex='Aem')|\\
\end{tabular}
\caption{\label{tab:ph_sel_smfret}Photon selection syntax (non-ALEX)}
\end{table}

\begin{table}
\begin{tabular}{l|l}
  Photon selection  & code \\
  \hline
  All-photons & \verb|Ph_sel('all')|\\
  D-emission during D-excitation & \verb|Ph_sel(Dex='Dem')|\\
  A-emission during D-excitation & \verb|Ph_sel(Dex='Aem')|\\
  D-emission during A-excitation & \verb|Ph_sel(Aex='Dem')|\\
  A-emission during A-excitation & \verb|Ph_sel(Aex='Aem')|\\
\end{tabular}
\caption{\label{tab:ph_sel_alex}Photon selection syntax (ALEX)}
\end{table}
